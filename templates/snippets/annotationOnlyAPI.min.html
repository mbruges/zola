<style>
div#definitions{display:none;}abbr{background-color:color-mix(in srgb,var(--a),transparent 80%);font-family:sans-serif;text-decoration:none;color:inherit;font-family:inherit;padding-left:.2em;padding-right:.2em;margin-left:-.2em;margin-right:-.2em;position:relative;cursor:help;border:1px solid #fff0}.def{background-color:transparent!important;border-bottom:1pt dashed var(--a)!important;border-radius:0}abbr:hover,abbr:focus{border:1px solid var(--a)!important}abbr:hover::after,abbr:focus::after{--abbr-width:15em;content:attr(data-title);font-size:.85em;padding-bottom:3em;position:absolute;left:50%;transform:translate(-50%,-.25rem);bottom:82%;min-width:var(--abbr-width);text-overflow:ellipsis;text-align:center;background-color:var(--a);color:var(--b);box-shadow:1px 1px 5px 0 rgb(0 0 0 / .4);font-size:14px;padding:3px 5px;z-index:999}.def:hover::after,.def:focus::after{background-color:var(--b);color:var(--t);font-style:italic;bottom:-1.55rem;border:1pt dashed var(--a)!important;max-height:1.1rem;line-height:.9em;height:1.1em;overflow-y:auto}@media screen and (max-width:500px){abbr:hover::after,abbr:focus::after{left:110%}}@media print{div#definitions{display:block!important}}
</style>
<script>
const approvedUsers=["acct:mbruges@hypothes.is"];
function setTabIndex(){let tabIndex=3;const abbrElements=document.querySelectorAll("abbr");abbrElements.forEach((abbr)=>{abbr.setAttribute("tabindex",tabIndex);tabIndex++})}
function addAnnotationToPage(annotation){const{target,text:rawText}=annotation;const text=rawText.replace(/"/g,"&quot;");var startContainer=target[0].selector[0].startContainer;startContainer="/"+startContainer;const exactText=annotation.target[0].selector.find((sel)=>sel.type==="TextQuoteSelector",).exact;const xpathResult=document.evaluate(startContainer,document,null,XPathResult.ANY_UNORDERED_NODE_TYPE,);const container=document.evaluate(startContainer,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null,).singleNodeValue;if(container){console.log(container.innerHTML);container.innerHTML=container.innerHTML.replace(exactText,`<abbr href="#" class="note" data-title="${text}">${exactText}</abbr>`,)}}
async function fetchAnnotations(){console.log("fetching annotations");const pageUrl=encodeURIComponent(window.location.origin+window.location.pathname,);const response=await fetch(`https://hypothes.is/api/search?uri=${pageUrl}`,{headers:{Accept:"application/vnd.hypothesis.v1+json",},},);if(response.ok){const data=await response.json();data.rows.forEach((annotation)=>{if(approvedUsers.includes(annotation.user)){addAnnotationToPage(annotation)}else{console.log("Unapproved user: "+annotation.user)}});setTabIndex()}else{console.error("Failed to fetch annotations",response.status)}}
window.addEventListener("load",()=>{console.log("window loaded");fetchAnnotations()});let hasFetched=!1;window.addEventListener("click",()=>{if(!hasFetched){console.log("fetching annotations");hasFetched=!0}})
</script>
