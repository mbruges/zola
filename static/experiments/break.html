<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/images/repton-blue.png" type="image/png">
        <meta property="og:title" content="Breaktime" />
        <meta property="og:description" content="Is it Red Break?" />
        <meta property="og:image" content="/images/repton-blue.png" />
        <meta property="og:url" content="https://www.maxbruges.com/experiments/break.html" />
    <title>Breaktime</title>
</head>

<style>

.loader {
 /* border: 9px solid #f3f3f3;
 border-top: 9px solid #3498db;
 border-radius: 50%; */
 width: 40px;
 height: 48px;
 animation: spin 1s linear infinite;
 padding:0px;
 font-family: monospace;
 margin:0px;
}

@keyframes spin {
 0% { transform: rotate(0deg); }
 100% { transform: rotate(360deg); }
}

body {
    background-color:slategrey;
    text-align: center;
}
h1 {
    text-shadow: 1px 1px 0px black;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 30pt;

    color: white;
}

#time {
    color:lightgrey;
}

</style>

<script>
fetch("https://api.mxb.fyi/break")
  .then(response => response.json())
  .then(data => {
    console.log(data.message);
    timestamp = data.timestamp.replace('\\n','')
    const currentTime = Math.floor(Date.now() / 1000);
    const timeDiff = currentTime - timestamp;
    let timeString;
    if (timeDiff < 60) {
      timeString = `${timeDiff} seconds ago`;
    } else if (timeDiff < 3600) {
      timeString = `${Math.floor(timeDiff / 60)} minutes ago`;
    } else {
      timeString = `${Math.floor(timeDiff / 3600)} hours ago`;
    }
    status = data.status
      var title = document.getElementById('title');
      text = "?"
      if ((status.toLowerCase().includes("red")) || (status.toLowerCase().includes("amber"))) {
        text = "RED";
        document.body.style.backgroundColor = "red";
        emoji = 'üî¥'
      } else {
        text = "GREEN";
        document.body.style.backgroundColor = "seagreen";
        emoji = 'üü¢'
      }
      title.className = "";
      document.title = `${emoji} ${text} break`
      title.innerHTML = `It's ${text} break`
      document.getElementById('time').innerText = `Last updated: ${timeString}`
    })
    .catch(error => console.error('Error:', error));
</script>
<body>
    <h1 id=title class="loader">‚òÄÔ∏è</h1>
    <small id="time"></small>
</body>
