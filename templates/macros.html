{% macro get_defs(content, type="text") %}
    {% set data = load_data(path="/dictionary.yaml") -%}
    {% for word, def in data %}
        {% if content is containing(word) %}
            {% set abbr = "<abbr class=def data-title='" ~ word ~ "_DEF_HERE'>" ~ word ~ "</abbr>" %}
            {% set_global content = content | safe | replace(from=' ' ~ word ~ ' ', to=' ' ~ abbr ~ ' ') %}
            {% set_global content = content | safe | replace(from=' ' ~ word ~ '\n', to=' ' ~ abbr ~ '\n') %}
            {% set_global content = content | safe | replace(from=' ' ~ word ~ '!', to=' ' ~ abbr ~ '!') %}
            {% set_global content = content | safe | replace(from=' ' ~ word ~ '.', to=' ' ~ abbr ~ '.') %}
            {% set_global content = content | safe | replace(from=" " ~ word ~ ",", to=" " ~ abbr ~ ",") %}
        {% endif %}
    {% endfor %}
    {% for word, def in data %}
        {% if content is containing(word) %}
            {%- set_global content = content | safe | replace(from=word ~ "_DEF_HERE", to=def) -%}
        {% endif %}
    {% endfor %}

    {% set_global def_list = "<div id='definitions'><h3>DEFINITIONS: </h3><ul>" %}
        {% for word, def in data %}
            {% if content is containing(word) %}
                {% set_global def_list = def_list ~ "<li><b>" ~ word ~ "</b>: " ~ def ~ "</li>" %}
            {% endif %}
        {% endfor %}
    {% if def_list is ending_with("</li>") %}
        {%- set_global content = content ~ def_list ~ "</ul>" -%}
    {% endif %}
    {{- content | safe -}}
{% endmacro get_defs %}
